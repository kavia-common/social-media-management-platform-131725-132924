{"is_source_file": true, "format": "C#", "description": "This file defines a middleware component for an ASP.NET Core application that ensures the presence of the ClaimTypes.NameIdentifier claim in a JWT token. It maps the 'sub' claim to NameIdentifier if necessary.", "external_files": ["System.Security.Claims", "Microsoft.AspNetCore.Http"], "external_methods": ["ClaimsPrincipal.Claims.Any", "ClaimsPrincipal.Claims.FirstOrDefault", "ClaimsIdentity.AddClaim", "ClaimsIdentity.Identity", "HttpContext.User", "RequestDelegate", "HttpContext"], "published": ["Global::dotnet.Middleware.JwtClaimMappingMiddleware"], "classes": [{"name": "JwtClaimMappingMiddleware", "description": "Middleware to ensure ClaimTypes.NameIdentifier is present in the JWT claims by mapping from the 'sub' claim if necessary."}], "methods": [{"name": "JwtClaimMappingMiddleware", "description": "Constructor that takes a RequestDelegate to invoke the next middleware component."}, {"name": "InvokeAsync", "description": "Asynchronous method that checks if the user is authenticated, verifies the presence of NameIdentifier claim, and adds it from 'sub' claim if missing."}], "calls": ["principal.Claims.Any", "principal.Claims.FirstOrDefault", "identity?.AddClaim", "await _next(context)"], "search-terms": ["JwtClaimMappingMiddleware", "ClaimsIdentity", "sub claim mapping", "ASP.NET Core middleware", "ClaimsPrincipal", "Jwt token claims"], "state": 2, "file_id": 23, "knowledge_revision": 52, "git_revision": "", "hash": "b6ea9eb2af96675f51dc86c40a5b6f4f", "format-version": 4, "code-base-name": "automation_backend", "filename": "automation_backend/Middleware/JwtClaimMappingMiddleware.cs", "revision_history": [{"52": ""}]}